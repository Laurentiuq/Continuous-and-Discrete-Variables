---
title: "Raport"
author: "Nechita Maria-Ilinca, Ghetoiu Gheorghe-Laurentiu"
output: html_document
date: "2023-01-26"
---

# Enunt
O aplicație în care să ilustrați o serie de repartiții discrete și continue (minim 15) și modul în care pot fi utilizate în calcul: astfel pentru fiecare repartiție să aveți posibilitatea să selectați valorile parametrilor care definesc repartiția, să ilustrați grafic densitatea (respectiv funcția de masă) și funcția de repartiție, să calculați probabilități de tipul $A = \mathrm{P}(X \le a), \mathrm{P}(X \ge b)$ sau $\mathrm{P}(a \le X \le b)$, pentru valori ale lui $a$ si $b$ date si sa ilustrati grafic probabilitatea calculata prin hasurarea zonei corespunzatoare.

## Afisare
Pentru toate elementele ce se afiseaza, mai putin sidebar, am folosit box astfel:
Avem doua sliders **Alpha** si **Beta**, valorile date de ele(alpha_, respectiv beta_) o sa fie folosite pe parcurs la toate distributiile care necesita/permit doua variabile.
Vor fi preluate in toate distributiile ca "a" si "b"(in variabilele a si b)

**oneParam** este folosit pentru distributiile care necesita doar un parametru
valoarea acestuia(alphaS_) o sa fie preluata ca "a"(in variabila a)


Avem cate un plot pentru: 
 - functia de densitate 
 - functia de repartitie
 - functia de repartitie cu calculul probabilitatilor de tipul:  
$A = \mathrm{P}(X \le a)$  
$\mathrm{P}(X \ge b)$  
$\mathrm{P}(a \le X \le b)$  




```{r include=FALSE}
library(shiny)
library(shinydashboard)
library(ggplot2)
library(shinyjs)
library(r2symbols)
library(actuar) # pentru pareto
```

```{r interfata}
# Define the user interface
ui <- dashboardPage(
  dashboardHeader(),
  dashboardSidebar(
    #side-bar
    selectInput("dist", "Select a Distribution:", 
                c("Normal" = "norm", "Uniform" = "unif", "Exponential" = "exp", "Poisson" = "pois", "Binomial" = "binom", "Geometric" = "geom", "Gamma" = "gamma", "Beta" = "beta", "Chi-Squared" = "chisq", 
                  "F" = "f", "t" = "t", "Cauchy" = "cauchy", "Laplace" = "laplace", "Log-Normal" = "lnorm", "Weibull" = "weibull", "Pareto" = "pareto"))
    
  ),
  #Folosim box
  
  # Avem doua sliders "Alpha" si "Beta", valorile date de ele(alpha_, respectiv beta_) o sa fie folosite pe parcurs la toate distributiile care necesita/permit doua variabile
  # vor fi preluate in toate distributiile ca "a" si "b"(in variabilele a si b)
  
  # oneParam este folosit pentru distributiile care necesita doar un parametru
  # valoarea acestuia(alphaS_) o sa fie preluata ca "a"(in variabila a)
  dashboardBody(
    useShinyjs(),
    hidden(
      div(id = "alphaBeta", 
          box(
            title = "Alpha",
            sliderInput("alpha_", "alpha_", 0.1, 1, 0.1)
          ),
          div(id = "onlyBeta",
            box(
              title = "Beta",
              sliderInput("beta_", "beta_", 0.1, 1, 0.1),
            )
          ),
      ),
      div(id = "oneParam",
          box(
            title = "AlphaS",
            sliderInput("alphaS_", "alphaS_", 0.1, 1, 0.1), width = 900
          ))
    ),
    
    
    # Avem cate un plot pentru: 
    # - functia de densitate 
    # - functia de repartitie
    # - functia de repartitie cu calculul probabilitatilor de tipul"
    # P(X <= a), P(X >= b), P(a <= X <= B)
    
    # Slider pentru A si pentru B
    fluidRow(
      box(plotOutput("density", height=450)),
      box(plotOutput("distribution", height = 450)),
      box(plotOutput("distributionWithProb")),
      box(title = "P", height = 150,
            h4(id = "P1", textOutput("P1")),
            h4(id = "P2", textOutput("P2")),
            h4(id = "P3", textOutput("P3"))
          ),
      box(
      sliderInput("A", "A", 0, 10, 0, 0.1),
      
      sliderInput("B", "B", 0, 10, 1, 0.1),
      height = 250
      )
    ),
    
  )
)

```  

Pentru fiecare distributie calculata vom actualiza ce slider folosim si ce valori pot sa fie selectate: 
```{r eval=FALSE}
 # afisam alphaBeta pentru ca avem nevoie de doua variabile
      show("alphaBeta")
      # Ascundem slider-ul cu o singura variabila
      hide("oneParam")
      
      # Adaptam valorile ce pot sa fie selectate pentru distributia curenta
      updateSliderInput(session, "alpha_", label = symbol("alpha"),value=1, 
                        0, 10, 0.1
      )
      updateSliderInput(session, "beta_", label = HTML("beta"), value=1,
                        0, 10, 0.1
      )
      
      updateSliderInput(session, "A", label = symbol("A"),value=0, 
                        0, 1, 0.1
      )
      updateSliderInput(session, "B", label = symbol("B"),value=0, 
                        0, 1, 0.1
      )
```    



## Distributii:
```{r, echo = FALSE}
# shinyAppDir(
#  system.file("./ProiectR"),
#  options = list(width = "100%", height = 700)
# )
```

### Distributie Beta
```{r, eval=FALSE }
if(input$dist == "beta"){
      # afisam alphaBeta pentru ca avem nevoie de doua variabile
      show("alphaBeta")
      # Ascundem slider-ul cu o singura variabila
      hide("oneParam")
      
      # Adaptam valorile ce pot sa fie selectate pentru distributia curenta
      updateSliderInput(session, "alpha_", label = symbol("alpha"),value=1, 
                        0, 10, 0.1
      )
      updateSliderInput(session, "beta_", label = HTML("beta"), value=1,
                        0, 10, 0.1
      )
      
      updateSliderInput(session, "A", label = symbol("A"),value=0, 
                        0, 1, 0.1
      )
      updateSliderInput(session, "B", label = symbol("B"),value=0, 
                        0, 1, 0.1
      )
      
      # Functia de densitate
      output$density <-renderPlot({
        x <- seq(0, 1, length = 1000)
        a <- input$alpha_
        b <- input$beta_
        density <- dbeta(x, shape1 = a, shape2 = b)
        ggplot() + 
          geom_line(aes(x=x,y=density), color="blue")+
          ggtitle(paste0("Densitatea a = ", a, " b = ", b))+
          xlab("X") + ylab("Density")
      })
      
      # Functia de distributie
      output$distribution <-renderPlot({
        x <- seq(0, 1, length = 1000)
        a <- input$alpha_
        b <- input$beta_
        distribution <- pbeta(x, shape1 = a, shape2 = b)
        ggplot() +
          geom_line(aes(x=x, y=distribution), color = "red")
        # polygon(x = seq(0.2,0.5,0.01), y=distribution, col="green")
        # geom_area(aes(x=c(0.3,0.5), y=distribution), fill="green", alpha=0.3)
        # ggtitle(paste0("Repartitia a = ", a, "b = ", b))+
        # xlab("X") + ylab("Densitatea")
        
      })
      
      # Functia de distributie cu probabilitatile specifice
      output$distributionWithProb<-renderPlot({
        x <- seq(0, 1, length = 1000)
        a <- input$alpha_
        b <- input$beta_
        A <- input$A
        B <- input$B
        distribution <- pbeta(x, shape1 = a, shape2 = b)
        
        # Pentru P(X ≤ A)
        xs <- seq(0, A, by = 0.01)
        xs1 <- c(xs, seq(A, 0, by =-0.01))
        ys <- c(c(pbeta(xs, shape1 = a, shape2 = b)), seq(0,0,length = length(xs)))
        
        # Pentru P( X ≥ B)
        xt <- seq(B, 1, by = 0.01)
        xt1 <- c(xt, seq(1, B, by = -0.01))
        yt <- c(c(pbeta(xt, shape1 = a, shape2 = b)), seq(0,0,length = length(xt)))
        
        # Pentru P(A ≤ X ≤ B)
        xf <- seq(A, B, by =0.01)
        xf1 <- c(xf, seq(B, A, by =-0.01))
        yf <- c(c(pbeta(xf, shape1 = a, shape2 = b)), seq(0,0, length = length(xf)))
        polygon(xf1, yf, col = "blue")
        
        
        
        # Calculam probabilitatile si le afisam ca text
        output$P1<-renderText(paste0(HTML("P(X ≤ A) = "), round(pbeta(A, shape1 = a, shape2 = b), digits = 2)))
        output$P2<-renderText(paste0(HTML("P( X ≥ B) = "), round(1 - pbeta(B, shape1 = a, shape2 = b), digits = 2)))
        output$P3<-renderText(paste0(HTML("P(A ≤ X ≤ B) = "), round(pbeta(B, shape1 = a, shape2 = b) - pbeta(A, shape1 = a, shape2 = b), digits= 2)))
        
        # Coloram aria de sub grafic
        ggplot() +
          geom_line(aes(x=x, y=distribution), color = "red")+
          geom_polygon(aes(x= xs1, y=ys), colour = "purple", fill="purple")+
          geom_polygon(aes(x= xt1, y=yt), colour = "blue", fill="blue")+
          geom_polygon(aes(x= xf1, y=yf), colour = "grey", fill="grey")
      })
      
      
    }
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
